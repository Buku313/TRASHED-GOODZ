<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>TRASHEDGOODS.STORE - Admin Panel</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="github-config.js" onerror="console.log('github-config.js not found - auto-save disabled')"></script>
    <script type="text/javascript" src="github-api.js"></script>
    <script type="text/javascript" src="admin.js"></script>
    <script type="text/javascript">
        // Check authentication on page load
        function checkAuth() {
            var loggedIn = localStorage.getItem('tgs_admin_logged_in');
            var session = localStorage.getItem('tgs_admin_session');

            if (loggedIn !== 'true' || !session) {
                window.location.href = 'login.html';
                return;
            }

            // Check if session is still valid (24 hours)
            var sessionTime = parseInt(session);
            var currentTime = Date.now();
            var hoursPassed = (currentTime - sessionTime) / (1000 * 60 * 60);

            if (hoursPassed >= 24) {
                // Session expired
                localStorage.removeItem('tgs_admin_logged_in');
                localStorage.removeItem('tgs_admin_session');
                window.location.href = 'login.html';
                return;
            }

            // Authentication successful, load admin data
            loadAdminData();
        }
    </script>
</head>
<body onload="checkAuth()">

<!-- Header -->
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#FFFFFF">
    <tr>
        <td>
            <table width="980" border="0" align="center" cellpadding="5" cellspacing="0">
                <tr>
                    <td width="300">
                        <font size="6" color="#CC0000"><b>TRASHEDGOODS.STORE</b></font>
                    </td>
                    <td align="right">
                        <font size="2">
                        <a href="index.html">Back to Store</a> |
                        <a href="#" onclick="logout()">Logout</a>
                        </font>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<!-- Navigation -->
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#CC0000">
    <tr>
        <td height="30">
            <table width="980" border="0" align="center" cellpadding="5" cellspacing="0">
                <tr>
                    <td>
                        <font color="#FFFFFF" size="3">
                        <b>ADMIN CONTROL PANEL</b>
                        </font>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<!-- Main Content -->
<table width="980" border="0" align="center" cellpadding="10" cellspacing="0">
    <tr>
        <td valign="top">

            <!-- Auto-Save Status -->
            <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC" id="autoSaveStatus">
                <tr>
                    <td align="center">
                        <font size="3" id="autoSaveTitle">
                        <b>Loading...</b><br />
                        </font>
                        <font size="2" id="autoSaveMessage">
                        <span id="savingIndicator"></span>
                        </font>
                    </td>
                </tr>
            </table>
            <script type="text/javascript">
                // Check if auto-save is available
                (function() {
                    var statusBox = document.getElementById('autoSaveStatus');
                    var title = document.getElementById('autoSaveTitle');
                    var message = document.getElementById('autoSaveMessage');

                    if (typeof GITHUB_CONFIG !== 'undefined' && GITHUB_CONFIG.token && GITHUB_CONFIG.token !== 'YOUR_GITHUB_TOKEN_HERE') {
                        statusBox.style.backgroundColor = '#E6F7FF';
                        title.innerHTML = '<b>üöÄ SEAMLESS AUTO-SAVE ENABLED</b><br />';
                        message.innerHTML = 'Changes automatically save to GitHub and go live in 1-2 minutes!<br /><span id="savingIndicator"></span>';
                    } else {
                        statusBox.style.backgroundColor = '#FFF3CD';
                        title.innerHTML = '<b>‚ö†Ô∏è AUTO-SAVE NOT CONFIGURED</b><br />';
                        message.innerHTML = 'Use "Export Data to File" button below to save changes.<br />See <a href="SETUP_AUTO_SAVE.md" target="_blank">setup guide</a> to enable auto-save.';
                    }
                })();
            </script>

            <br />

            <!-- Manual Options -->
            <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC" bgcolor="#F5F5F5">
                <tr>
                    <td align="center">
                        <font size="2">
                        <b>Manual Options:</b>
                        <input type="button" value="üíæ Save to GitHub Now" onclick="saveToGitHub()" style="font-weight:bold; padding:5px 10px;" />
                        &nbsp;&nbsp;|&nbsp;&nbsp;
                        <input type="button" value="Export Data to File" onclick="exportData()" />
                        &nbsp;&nbsp;|&nbsp;&nbsp;
                        <b>Import:</b>
                        <input type="file" id="importFile" accept=".json" onchange="importData()" />
                        </font>
                    </td>
                </tr>
            </table>

            <br />

            <!-- Tab Navigation -->
            <table width="100%" border="0" cellpadding="5" cellspacing="0">
                <tr bgcolor="#F0F0F0">
                    <td width="200" align="center" id="itemsTab" style="cursor:pointer; background-color:#3366CC;" onclick="showTab('items')">
                        <font color="#FFFFFF"><b>Manage Items</b></font>
                    </td>
                    <td width="200" align="center" id="categoriesTab" style="cursor:pointer;" onclick="showTab('categories')">
                        <font><b>Manage Categories</b></font>
                    </td>
                    <td width="200" align="center" id="hotCategoriesTab" style="cursor:pointer;" onclick="showTab('hotCategories')">
                        <font><b>Hot Categories</b></font>
                    </td>
                    <td>&nbsp;</td>
                </tr>
            </table>

            <br />

            <!-- Items Management Section -->
            <div id="itemsSection">
                <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC">
                    <tr bgcolor="#3366CC">
                        <td colspan="2">
                            <font color="#FFFFFF" size="3"><b>Add / Edit Featured Item</b></font>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <form id="itemForm" onsubmit="saveItem(event)">
                                <table width="100%" border="0" cellpadding="5" cellspacing="0">
                                    <tr>
                                        <td width="150"><b>Item ID:</b></td>
                                        <td><input type="text" id="itemId" name="itemId" size="10" readonly style="background-color:#F0F0F0;" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Item Name:</b></td>
                                        <td><input type="text" id="itemName" name="itemName" size="60" required /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Price:</b></td>
                                        <td>$<input type="text" id="itemPrice" name="itemPrice" size="10" required /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Image URL:</b></td>
                                        <td><input type="text" id="itemImage" name="itemImage" size="60" placeholder="https://via.placeholder.com/150x150?text=Item" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Bids:</b></td>
                                        <td><input type="text" id="itemBids" name="itemBids" size="5" value="0" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Time Left:</b></td>
                                        <td><input type="text" id="itemTime" name="itemTime" size="20" placeholder="2h 15m left" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Extra Info:</b></td>
                                        <td><input type="text" id="itemInfo" name="itemInfo" size="40" placeholder="Buy It Now available" /></td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>
                                            <input type="submit" value="Add Item" />
                                            <input type="button" value="Clear Form" onclick="clearItemForm()" />
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </td>
                    </tr>
                </table>

                <br />

                <!-- Current Items List -->
                <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC">
                    <tr bgcolor="#F0F0F0">
                        <td colspan="8">
                            <b>Current Featured Items</b>
                        </td>
                    </tr>
                    <tr bgcolor="#E0E0E0">
                        <td><b>ID</b></td>
                        <td><b>Name</b></td>
                        <td><b>Price</b></td>
                        <td><b>Bids</b></td>
                        <td><b>Time</b></td>
                        <td><b>Info</b></td>
                        <td><b>Edit</b></td>
                        <td><b>Delete</b></td>
                    </tr>
                    <tbody id="itemsList">
                        <!-- Items will be loaded here by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Categories Management Section -->
            <div id="categoriesSection" style="display:none;">
                <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC">
                    <tr bgcolor="#3366CC">
                        <td colspan="2">
                            <font color="#FFFFFF" size="3"><b>Add / Edit Category</b></font>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <form id="categoryForm" onsubmit="saveCategory(event)">
                                <table width="100%" border="0" cellpadding="5" cellspacing="0">
                                    <tr>
                                        <td width="150"><b>Category ID:</b></td>
                                        <td><input type="text" id="categoryId" name="categoryId" size="10" readonly style="background-color:#F0F0F0;" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Category Name:</b></td>
                                        <td><input type="text" id="categoryName" name="categoryName" size="40" required /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Category Link:</b></td>
                                        <td><input type="text" id="categoryLink" name="categoryLink" size="40" placeholder="#" /></td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>
                                            <input type="submit" value="Add Category" />
                                            <input type="button" value="Clear Form" onclick="clearCategoryForm()" />
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </td>
                    </tr>
                </table>

                <br />

                <!-- Current Categories List -->
                <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC">
                    <tr bgcolor="#F0F0F0">
                        <td colspan="5">
                            <b>Current Categories (Sidebar)</b>
                        </td>
                    </tr>
                    <tr bgcolor="#E0E0E0">
                        <td><b>ID</b></td>
                        <td><b>Name</b></td>
                        <td><b>Link</b></td>
                        <td><b>Edit</b></td>
                        <td><b>Delete</b></td>
                    </tr>
                    <tbody id="categoriesList">
                        <!-- Categories will be loaded here by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Hot Categories Management Section -->
            <div id="hotCategoriesSection" style="display:none;">
                <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC">
                    <tr bgcolor="#3366CC">
                        <td colspan="2">
                            <font color="#FFFFFF" size="3"><b>Add / Edit Hot Category</b></font>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <form id="hotCategoryForm" onsubmit="saveHotCategory(event)">
                                <table width="100%" border="0" cellpadding="5" cellspacing="0">
                                    <tr>
                                        <td width="150"><b>Hot Cat ID:</b></td>
                                        <td><input type="text" id="hotCategoryId" name="hotCategoryId" size="10" readonly style="background-color:#F0F0F0;" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Name:</b></td>
                                        <td><input type="text" id="hotCategoryName" name="hotCategoryName" size="40" required /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Description:</b></td>
                                        <td><input type="text" id="hotCategoryDesc" name="hotCategoryDesc" size="60" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Image URL:</b></td>
                                        <td><input type="text" id="hotCategoryImage" name="hotCategoryImage" size="60" placeholder="https://via.placeholder.com/100x100?text=Category" /></td>
                                    </tr>
                                    <tr>
                                        <td><b>Link:</b></td>
                                        <td><input type="text" id="hotCategoryLink" name="hotCategoryLink" size="40" placeholder="#" /></td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>
                                            <input type="submit" value="Add Hot Category" />
                                            <input type="button" value="Clear Form" onclick="clearHotCategoryForm()" />
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </td>
                    </tr>
                </table>

                <br />

                <!-- Current Hot Categories List -->
                <table width="100%" border="1" cellpadding="10" cellspacing="0" bordercolor="#CCCCCC">
                    <tr bgcolor="#F0F0F0">
                        <td colspan="6">
                            <b>Current Hot Categories (Max 4 recommended)</b>
                        </td>
                    </tr>
                    <tr bgcolor="#E0E0E0">
                        <td><b>ID</b></td>
                        <td><b>Name</b></td>
                        <td><b>Description</b></td>
                        <td><b>Link</b></td>
                        <td><b>Edit</b></td>
                        <td><b>Delete</b></td>
                    </tr>
                    <tbody id="hotCategoriesList">
                        <!-- Hot Categories will be loaded here by JavaScript -->
                    </tbody>
                </table>
            </div>

        </td>
    </tr>
</table>

<!-- Footer -->
<table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#F0F0F0">
    <tr>
        <td height="60">
            <table width="980" border="0" align="center" cellpadding="10" cellspacing="0">
                <tr>
                    <td align="center">
                        <font size="1">
                        TRASHEDGOODS.STORE Admin Panel - 2008<br />
                        All changes are saved to browser localStorage
                        </font>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

</body>
</html>